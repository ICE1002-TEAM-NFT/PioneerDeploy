<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="author" content="원효민">
    <meta name="description" content="빈 강의실 이용 현황을 알려주는 사이트입니다.">
    <meta name="keywords" content="강의실 이용, 빈 강의실, 인하대 강의실">
    <meta name="generator" content="brakets">
    <title>빈 강의실 이용 현황</title>

    <!-- CSS STYLE -->
    <link rel="stylesheet" href="/static/css/reset2.css">
    <link rel="stylesheet" href="/static/css/style2.css">

    <!-- 웹 폰트 -->
    <link href="https://fonts.googleapis.com/css?family=Nanum+Gothic&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Nanum+Brush+Script&display=swap" rel="stylesheet">
</head>

<body>
    <!-- 스킵 내비게이션 -->
    <div id="skip">
        <a href="#cont_cont">컨텐츠 메뉴 바로가기</a>
    </div>
    <!-- //스킵 내비게이션 -->

    <div id="wrap">
        <div id="header">
            <div class="container">
                <div class="header">
                    <!-- //헤더 메뉴 -->
                    <div class="header-tit">
                        <h1>빈 강의실 이용 현황</h1><br>
                        <a href="http://whm6149.dothome.co.kr/web/index.html">whm6149.dothome.co.kr</a>
                    </div>
                    <!-- //헤더 타이틀 -->
                    <div class="header-icon"></div>
                </div>
            </div>
        </div>
        <!-- //header -->

        <div id="contents">
            <div id="cont_cont">
                <div class="container"></div>
            </div>
            <!-- //cont_cont -->
        </div>
        <div id="cont_cont">
            <div class="container">
                <div class="cont">
                    <div class="column col1">
                        <h3><span class="ico_tit">5호동관(5-4동)</span></h3>
                        <button id="change_button" type="button" onclick='fn_display()' >정보 불러오기</button>
                        <p class="ico_desc"></p>
                        <!-- 게시판 1 -->
                        <div class="notice1">
                            <h4>강의실</h4>
                            <ul>
                                <li><a href="#">-102</a><p class="102_state">빈 강의실입니다.</p></li>
                                <li><a href="#">-105A</a><p>빈 강의실입니다.</p></li>
                                <li><a href="#">-105B</a><p>빈 강의실입니다.</p></li>
                                <li><a href="#">-106A</a><p>빈 강의실입니다.</p></li>
                                <li><a href="#">-106B</a><p>빈 강의실입니다.</p></li>
                                <li><a href="#">-107A</a><p>빈 강의실입니다.</p></li>
                                <li><a href="#">-107B</a><p>빈 강의실입니다.</p></li>
                                <li><a href="#">-110</a><p>빈 강의실입니다.</p></li>
                                <li><a href="#">-111</a><p>빈 강의실입니다.</p></li>
                            </ul>

                        </div>
                        <!-- //게시판 1 -->
                    </div>
                    <!-- //col1 -->
                    <div class="column col2">
                        <h3><span class="ico_tit"></span></h3>
                        <p class="ico_desc"></p>
                        <!-- 게시판 2 -->
                        <div class="notice2">
                            <h4>강의실</h4>
                            <ul>
                                <li><a href="#">-115</a></li>
                                <li><a href="#">-202</a></li>
                                <li><a href="#">-207A</a></li>
                                <li><a href="#">-207B</a></li>
                                <li><a href="#">-208A</a></li>
                                <li><a href="#">-208B</a></li>
                                <li><a href="#">-210A</a></li>
                                <li><a href="#">-211</a></li>
                                <li><a href="#">-213A</a></li>
                            </ul>

                        </div>
                        <!-- //게시판 2 -->
                    </div>
                    <!-- //col2 -->
                    <div class="column col3">
                        <h3><span class="ico_tit"></span></h3>
                        <p class="ico_desc"></p>
                        <!-- 게시판 3 -->
                        <div class="notice3">
                            <h4>강의실</h4>
                            <ul>
                                <li><a href="#">-405</a></li>
                                <li><a href="#">-406</a></li>
                                <li><a href="#">-407</a></li>
                                <li><a href="#">-408</a></li>
                                <li><a href="#">-502</a></li>
                                <li><a href="#">-505</a></li>
                                <li><a href="#">-506</a></li>
                                <li><a href="#">-507</a></li>
                                <li><a href="#">-508</a></li>
                            </ul>

                        </div>
                        <!-- //게시판 3 -->
                    </div>
                    <!-- //col3 -->

                </div>
            </div>
            <!-- //contents -->

            <div id="footer">
                <div class="container">
                    <h2 class="ir_su"></h2>
                    <div class="footer">
                        <ul>
                            <li>창의적 정보통신공학설계</li>
                            <li>202202-ICE1002-004</li>
                            <li>팀장-이창용</li>
                            <li>팀원-원효민,장현수</li>
                            <li>웹 제작-원효민</li>
                        </ul>
                        <address>
                            Copyright©whm6149.co.kr All Right Reserved
                        </address>
                    </div>
                </div>
            </div>
            <!-- //footer -->
        </div>
        <!-- //wrap -->
</body>

<script>
    var tmp;
    var tmp_time;
    var today = new Date();
    var hours = ('0' + today.getHours()).slice(-2); 
    var minutes = ('0' + today.getMinutes()).slice(-2);
    var seconds = ('0' + today.getSeconds()).slice(-2); 

    function fn_fetch() {
        const response = fetch("/building_1/307");

        return response.then(res => res.json());
    }

    async function fn_display() {
        tmp = await fn_fetch();

        console.log(tmp);
        console.log(JSON.parse(tmp))

        const data = JSON.parse(tmp);
        const state102 = document.getElementsByClassName('102_state')[0];

        var sub_used_time_sec = Number(data.used_time.substr(17, 2))
        var sub_used_time_min = Number(data.used_time.substr(14, 2))
        var sub_used_time_hour = Number(data.used_time.substr(11, 2))

        if (data.info == "Empty") {
            // console.log(data.used_time)
            state102.innerText = data.used_time+"빈 강의실입니다!";
            // console.log(today)

            
        }

        else if (data.info == " Empty") {
            // console.log(data.used_time)
            // state102.innerText = data.used_time+"빈 강의실입니다!";
            // console.log(today)
            console.log(sub_used_time_sec)
            console.log(sub_used_time_min)
            console.log(sub_used_time_hour)

            if (hours == sub_used_time_hour + 9) {
                if (minutes == sub_used_time_min) {

                    if (seconds - sub_used_time_sec < 0) {
                        tmp_time = 60 - seconds + sub_used_time_sec;
                    }
                    else {
                        tmp_time = seconds - sub_used_time_sec;
                    }
                    state102.innerText = tmp_time+"초 전에 이용되었습니다.";
                }

                else {
                    if (minutes - sub_used_time_min < 0) {
                        tmp_time = 60 - minutes + sub_used_time_min;
                    }
                    else {
                        tmp_time = minutes - sub_used_time_min;
                    }
                    state102.innerText = tmp_time+"분 전에 이용되었습니다.";
                }
            }
            
            else {
                if (hours - sub_used_time_hour < 0) {
                        tmp_time = 24 - hours + sub_used_time_hour;
                    }
                        else {
                        tmp_time = hours - sub_used_time_hour;
                    }
                    state102.innerText = tmp_time+"시간 전에 이용되었습니다.";
            }
        }

        else {
            state102.innerText = "사용중인 강의실입니다.";
        }

    }


</script>

</html>